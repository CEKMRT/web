import { useState, useEffect } from "react";
import Button from "../ui/button1";
import { Schedule } from "./types"; // Assuming you have Schedule type defined

interface TombolStasiunProps {
  onSelectStation: (station: string) => void;
  fetchScheduleData: (station: string) => Promise<Schedule>;
}

const TombolStasiun: React.FC<TombolStasiunProps> = ({ onSelectStation, fetchScheduleData }) => {
  const [activeStations, setActiveStations] = useState<string[]>([]);
  const [stationData, setStationData] = useState<Record<string, Schedule>>({});

  const handleSelectStation = async (station: string) => {
    toggleActive(station);
    try {
      const data = await fetchScheduleData(station);
      updateStationData(station, data);
      onSelectStation(station);
    } catch (error) {
      console.error('Error fetching schedule data:', error);
    }
  };

  const toggleActive = (station: string) => {
    setActiveStations((prevActiveStations) => {
      const isActive = prevActiveStations.includes(station);
      return isActive
        ? prevActiveStations.filter((s) => s !== station)
        : [...prevActiveStations, station];
    });
  };

  const updateStationData = (station: string, data: Schedule) => {
    setStationData((prevData) => ({ ...prevData, [station]: data }));
  };

    return (
      <div>
        <div className="pt-2 relative overflow-hidden">
          <div className="flex flex-wrap justify-between justify-items-start content-center place-content-evenly gap-4 md:py-4 py-2 max-w-sm mx-auto bg-white shadow-md rounded-lg overflow-hidden md:max-w-2xl px-4 dark:bg-zinc-900 dark:border-slate-800 dark:border-2 z-10">
            <Button onClick={() => handleSelectStation("Bundaran HI")}>
              Bundaran HI
            </Button>
          <Button onClick={() => handleSelectStation("DukuhAtas")}>
            Dukuh Atas BNI
          </Button>
          <Button onClick={() => handleSelectStation("Setiabudi")}>
            Setiabudi Astra
          </Button>
          <Button onClick={() => handleSelectStation("Benhilaa")}>
            Bendungan Hilir
          </Button>
          {/* Repeat for other buttons */}
          <Button onClick={() => handleSelectStation("Mandiri")}>
            Istora Mandiri
          </Button>
          <Button onClick={() => handleSelectStation("Senayan")}>
            Senayan
          </Button>
          <Button onClick={() => handleSelectStation("Asean")}>Asean</Button>
          <Button onClick={() => handleSelectStation("Blok M")}>Blok M</Button>
          <Button onClick={() => handleSelectStation("Blok A")}>Blok A</Button>
          <Button onClick={() => handleSelectStation("Haji Nawi")}>
            Haji Nawi
          </Button>
          <Button onClick={() => handleSelectStation("Cipete")}>
            Cipete Raya
          </Button>
          <Button onClick={() => handleSelectStation("Fatmawati")}>
            Fatmawati
          </Button>
          <Button onClick={() => handleSelectStation("Lebak Bulus")}>
            Lebak Bulus Grab
          </Button>
        </div>
      </div>
      <div>
        {activeStations.map((station) => (
          <div key={station}>
            <h3>{station}</h3>
            <pre>{JSON.stringify(stationData[station], null, 2)}</pre>
          </div>
        ))}
      </div>
    </div>
  );
};

export default TombolStasiun;
